# github-tools

## Overview

This repository contains tools for working with GitHub repositories from
the command line. For now there is just one (`gh-pr-query`).

## Installation

First install the dependency, `PyGithub`:

```
pip install PyGithub
```

Then clone this repository and make sure that the top-level script,
`gh-pr-query` is in your path - either by adding the clone directory to
your path or by making a symbolic link somewhere that is already in your
path.

## Tools contained here

### gh-pr-query

Tool for querying GitHub Pull Requests

To show all comments in a pull request:

    gh-pr-query -r REPO -p PR_NUMBER -s

To show all of the outstanding todo items in all comments in a pull request
(i.e., all unchecked checkboxes):

    gh-pr-query -r REPO -p PR_NUMBER -t

For more detailed help, run

    gh-pr-query -h
    
#### Examples

##### Showing all comments

```bash
$ ./gh-pr-query -r esmci/github-tools -p 1 -s

PR #1: 'Changes for the sake of demo PR' by billsacks on 2020-04-23 19:24:00-06:00 (https://github.com/ESMCI/github-tools/pull/1):
    This PR is for demonstration purposes only.

    There is a checklist in the body:

    - [ ] Do a task suggested in the body
    - [x] Do another task suggested in the body

    After some more text, there is another checklist:

    - [ ] Do a task from the body's second checklist

    PR line comment by billsacks on 2020-04-23 19:25:28-06:00 (https://github.com/ESMCI/github-tools/pull/1#discussion_r414063434):
        I would like the following changes to this line:

        - [ ] Please change "just" to "only"
        - [ ] Please change "PR" to "Pull Request"

    PR review comment by billsacks on 2020-04-23 19:25:49-06:00 (https://github.com/ESMCI/github-tools/pull/1#pullrequestreview-399407911):
        In addition to my line comments, please also:

        - [ ] Add a section on Demo deletions

    Conversation comment by billsacks on 2020-04-23 19:26:39-06:00 (https://github.com/ESMCI/github-tools/pull/1#issuecomment-618612295):
        PR comments can also include checklist items

        - [x] I should do this
        - [ ] I should do that

    Conversation comment by billsacks on 2020-04-23 19:34:19-06:00 (https://github.com/ESMCI/github-tools/pull/1#issuecomment-618616900):
        Closing this PR that was for demonstration purposes only.
```

##### Showing all outstanding todo items

```bash
$ ./gh-pr-query -r esmci/github-tools -p 1 -t
- Do a task suggested in the body (billsacks at 2020-04-23 19:24:00-06:00, <https://github.com/ESMCI/github-tools/pull/1>)

- Do a task from the body's second checklist (billsacks at 2020-04-23 19:24:00-06:00, <https://github.com/ESMCI/github-tools/pull/1>)

- Please change "just" to "only" (billsacks at 2020-04-23 19:25:28-06:00, <https://github.com/ESMCI/github-tools/pull/1#discussion_r414063434>)

- Please change "PR" to "Pull Request" (billsacks at 2020-04-23 19:25:28-06:00, <https://github.com/ESMCI/github-tools/pull/1#discussion_r414063434>)

- Add a section on Demo deletions (billsacks at 2020-04-23 19:25:49-06:00, <https://github.com/ESMCI/github-tools/pull/1#pullrequestreview-399407911>)

- I should do that (billsacks at 2020-04-23 19:26:39-06:00, <https://github.com/ESMCI/github-tools/pull/1#issuecomment-618612295>)
```

## Providing a personal access token

The tools here accept an optional argument (`-a` / `--access-token`),
via which you can provide a GitHub personal access token. This is a
personal, random string generated by GitHub, which is NOT the same as
your GitHub password. These are described in more detail here:
<https://help.github.com/en/github/authenticating-to-github/creating-a-personal-access-token-for-the-command-line>. For
tools that only do read operations on public repositories, an access
token is not required. However, GitHub rate-limits fetches via the API,
and the limit is very small if you do not provide an access token. So,
in order to do more than a few queries per hour, you will likely need to
set up and provide a personal access token. If you only need read access
to public repositories, then you do not need to check any of the boxes
when setting up your access token.

You should protect this access token as you would a password. Tips for
how to do this are given in the wiki.
